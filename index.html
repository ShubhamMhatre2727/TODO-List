<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">

    <title>TODO List</title>
  </head>
  <body>
    <div class="container my-4">
      <nav>
        <div class="box-1">
          <h2><span id="DayDate"></span></h2>
      </div> 
      <div class="box-2">
          <span id="Time"></span>
          <span id="sec"></span>
          <span id="AmPm"></span>
      </div>
      </nav>
      <!-- Content here -->
      <h2 class="text-center">TODO List</h2>
      <div class="mb-3">
        <label class="form-label">Title</label>
        <input class="form-control" id="Title" aria-describedby="emailHelp">
        <div id="emailHelp" class="form-text">Enter your title here.</div>
      </div>
      <div class="mb-3">
        <label for="exampleFormControlTextarea1" class="form-label">Description</label>
        <textarea class="form-control" id="Description" rows="3"></textarea>
      </div>
      <button class="btn btn-primary" id="add">Add to list</button>
      <button class="btn btn-primary" onclick="cleared()" id="clear">Clear List</button>
      
      <div class="my-4">
        <h2>List</h2>

        <table class="table">
          <thead>
            <tr>
              <th scope="col">Sr. No.</th>
              <th scope="col">Title</th>
              <th scope="col">Description</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody id="tbody">
          </tbody>
        </table>
      </div>
    </div>



    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js" integrity="sha384-eMNCOe7tC1doHpGoWe/6oMVemdAVTMs2xqW4mwXrXsW0L84Iytr2wi5v2QjrP/xp" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/" crossorigin="anonymous"></script>
    -->

    <script>
      let a; let time; let date; let day;
      var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      const months = ['Jan', 'Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']
  
      setInterval(() => {
          a = new Date();
  
          // getting day in words
          day = days[a.getDay()]
  
          // getting date 
          const mm = months[a.getMonth()];
          const dd = a.getDate();
          const yy = a.getFullYear();
          date = dd + " " + mm + " " + yy +" "
  
          // getting time in 12 hr formats
          var minutes = a.getMinutes();
          var hours = a.getHours();
          var sec = a.getSeconds();
          var ampm = hours >= 12 ? 'PM' : 'AM';
          hours = hours % 12;
          hours = hours ? hours : 12; // the hour '0' should be '12'
          minutes = minutes < 10 ? '0'+minutes : minutes;
  
          // making them in two digit format
          hours = ("0" + (hours)).slice(-2)
          minutes = ("0" + (minutes)).slice(-2)
          sec = ("0" + (sec)).slice(-2)
          var strTime = hours + ':' + minutes + ":"+sec;
  
          document.getElementById("DayDate").innerHTML = day + ", " + date;
          document.getElementById("Time").innerHTML = strTime;
        //   document.getElementById("sec").innerHTML = ":"+sec;
          document.getElementById("AmPm").innerHTML = ampm;
      }, 1000);
      
  </script>

    <script>

      // initializing array
      if(localStorage.getItem("ItemsJson") == null){
          ListItems = [];
          localStorage.setItem("ItemsJson", JSON.stringify(ListItems))
      }
      else{
          ListItemsStr = localStorage.getItem("ItemsJson");
          ListItems = JSON.parse(ListItemsStr);
      }

      // To delete ietems
      function del(item){
        ListItems.splice(item, 1);
        localStorage.setItem("ItemsJson", JSON.stringify(ListItems))
        update();
      }

      // to populate list
      function update(){
        // this if statement is added becuase if the localstorage is cleared then it will create an empty array to sho empty table
        if(localStorage.getItem("ItemsJson") == null){
          ListItems = [];
          localStorage.setItem("ItemsJson", JSON.stringify(ListItems))
      }
        let tbody = document.getElementById("tbody");
        let str = '';
        ListItems.forEach((element, index) => {
          str += `
          <tr>
                <th scope="row">${index+1}</th>
                <td>${element[0]}</td>
                <td>${element[1]}</td>
                <td><button class="btn btn-sm btn-primary" onclick="del(${index})" >Delete</button></td>
          </tr> ` ;
        });
        tbody.innerHTML = str;
      }

      // clearing entire list
      function cleared(){
        if(confirm("Are you sue you want to clear your list ?")){
          // console.log("clearing")
          localStorage.clear();
          update();
        }
      }

      // initially populated the list
      update();

      // adding itemss to list
      add = document.getElementById("add");
      add.addEventListener("click", ()=>{
        title = document.getElementById("Title").value;
        desc = document.getElementById("Description").value;
        ListItems.push([title, desc]);
        localStorage.setItem("ItemsJson", JSON.stringify(ListItems))
        update()
      });

    </script>
  </body>
</html>